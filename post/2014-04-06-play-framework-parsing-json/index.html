<!DOCTYPE html>
<html lang="en-us">
<head>
<meta charset="utf-8">
<meta name="description" content="">
<meta name="generator" content="Hugo 0.53" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="/css/style.css" type="text/css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Code+Pro:400,700" type="text/css">
<link rel="alternate" href="/index.xml" type="application/rss+xml" title="barakyo">
<title>
  Play! Framework -- Parsing JSON - barakyo
</title>
</head>
<body>

<a href="https://barakyo.github.io/" style="text-decoration: none">
  <h1 class="article-title">
    <span class="base05">[</span>
    <span class="base08">b</span>
    <span class="base09">a</span>
    <span class="base0a">r</span>
    <span class="base0b">a</span>
    <span class="base0c">k</span>
    <span class="base0d">y</span>
    <span class="base05">o</span>
    <span class="base05">]</span>
  </h1>
</a>

<div class="container">


<main role="main" class="article">
  
<article class="single" itemscope itemtype="http://schema.org/BlogPosting">
  <h1 class="headline" itemprop="headline">Play! Framework -- Parsing JSON</h1>
  <div class="meta">
    
    <span class="key">published on</span>
    <span class="val"><time itemprop="datePublished" datetime="2014-04-06">April 06, 2014</time></span>
    
    
    <span class="key">in</span>
    <span class="val">
      
      <a href="/categories/Development">Development</a>
      
    </span>
    
    
    <br>
    <span class="key">tags:</span>
    <span class="val">
      
      <a href="/tags/Java">Java</a>
      
      <a href="/tags/Play!">Play!</a>
      
    </span>
    
  </div>
  <section class="body" itemprop="articleBody">
    

<h2 id="tl-dr">tl;dr</h2>

<p>I suggest using <code>ObjectMapper</code> found in the <code>com.fasterxml.jackson.databind.ObjectMapper</code></p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">    ObjectMapper mapper <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ObjectMapper<span style="color:#f92672">();</span>
    <span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>
        JsonNode root <span style="color:#f92672">=</span> request<span style="color:#f92672">().</span><span style="color:#a6e22e">body</span><span style="color:#f92672">().</span><span style="color:#a6e22e">asJson</span><span style="color:#f92672">();</span>
        JsonNode jsonPhoneNumbers <span style="color:#f92672">=</span> root<span style="color:#f92672">.</span><span style="color:#a6e22e">get</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;phoneNumbers&#34;</span><span style="color:#f92672">);</span>
        <span style="color:#66d9ef">for</span><span style="color:#f92672">(</span>JsonNode phoneNumberString <span style="color:#f92672">:</span> jsonPhoneNumbers<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
            String phoneNumber <span style="color:#f92672">=</span> phoneNumberString<span style="color:#f92672">.</span><span style="color:#a6e22e">asText</span><span style="color:#f92672">();</span>
        <span style="color:#f92672">}</span>
    <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>NullPointerException npe<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        <span style="color:#75715e">// No valid phone numbers were provided
</span><span style="color:#75715e"></span>    <span style="color:#f92672">}</span></code></pre></div>

<h2 id="using-objectmapper">Using ObjectMapper</h2>

<p>For parsing arrays in JSON requests, I suggest using the <code>ObjectMapper</code>. Assuming you have a request that looks like:</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json">    {
        <span style="color:#f92672">&#34;phoneNumbers&#34;</span>: [
            <span style="color:#e6db74">&#34;555-555-5555&#34;</span>,
            <span style="color:#e6db74">&#34;555-555-5556&#34;</span>,
            <span style="color:#e6db74">&#34;555-555-5557&#34;</span>
        ]
    }</code></pre></div>

<p>We can easily access the phone number values by using <code>ObjectMapper</code> class. The first thing that you&rsquo;d want to do is instantiate an instance of this class, which is pretty straight forward.
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">    
    ObjectMapper mapper <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ObjectMapper<span style="color:#f92672">();</span></code></pre></div></p>

<p>From there, we want a JSON version of our request, the Play framework allows you to easily do so by chaining the <code>asJson()</code> method to the <code>request().body()</code> functions.
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">    
    JsonNode root <span style="color:#f92672">=</span> request<span style="color:#f92672">().</span><span style="color:#a6e22e">body</span><span style="color:#f92672">().</span><span style="color:#a6e22e">asJson</span><span style="color:#f92672">();</span></code></pre></div></p>

<p>Using the <code>get()</code> function on our <code>root</code> object and providing the correct key, we can easily get our phoneNumbers as a JsonNode, which is also iterable. By iterating through each of the JsonNode objects, we can just return the value for the corresponding phone number as a <code>String</code> by using the <code>asText()</code> method.
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">    
    JsonNode jsonPhoneNumbers <span style="color:#f92672">=</span> root<span style="color:#f92672">.</span><span style="color:#a6e22e">get</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;phoneNumbers&#34;</span><span style="color:#f92672">);</span>
    <span style="color:#66d9ef">for</span><span style="color:#f92672">(</span>JsonNode phoneNumberString <span style="color:#f92672">:</span> jsonPhoneNumbers<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        String phoneNumber <span style="color:#f92672">=</span> phoneNumberString<span style="color:#f92672">.</span><span style="color:#a6e22e">asText</span><span style="color:#f92672">();</span>
    <span style="color:#f92672">}</span></code></pre></div></p>

<p>Since there is a possibility that the request could be empty (null), I suggest wrapping the request processing in a try-catch block. If a request is null or the specified key was not included in the request (in this example it would be <code>phoneNumbers</code>) then we can use the <code>catch</code> portion of the block to easily return a bad request.</p>

<p>Put this all together looks like:</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">    <span style="color:#f92672">import</span> com.fasterxml.jackson.databind.JsonNode<span style="color:#f92672">;</span>
    <span style="color:#f92672">import</span> com.fasterxml.jackson.databind.ObjectMapper<span style="color:#f92672">;</span>
    <span style="color:#f92672">import</span> com.fasterxml.jackson.databind.node.ObjectNode<span style="color:#f92672">;</span>
    <span style="color:#f92672">import</span> play.libs.Json<span style="color:#f92672">;</span>

    ObjectMapper mapper <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ObjectMapper<span style="color:#f92672">();</span>
    ObjectNode response <span style="color:#f92672">=</span> Json<span style="color:#f92672">.</span><span style="color:#a6e22e">newObject</span><span style="color:#f92672">();</span>
    <span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>
        JsonNode root <span style="color:#f92672">=</span> request<span style="color:#f92672">().</span><span style="color:#a6e22e">body</span><span style="color:#f92672">().</span><span style="color:#a6e22e">asJson</span><span style="color:#f92672">();</span>
        JsonNode jsonPhoneNumbers <span style="color:#f92672">=</span> root<span style="color:#f92672">.</span><span style="color:#a6e22e">get</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;phoneNumbers&#34;</span><span style="color:#f92672">);</span>
        <span style="color:#66d9ef">for</span><span style="color:#f92672">(</span>JsonNode phoneNumberString <span style="color:#f92672">:</span> jsonPhoneNumbers<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
            String phoneNumber <span style="color:#f92672">=</span> phoneNumberString<span style="color:#f92672">.</span><span style="color:#a6e22e">asText</span><span style="color:#f92672">();</span>
        <span style="color:#f92672">}</span>
    <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>NullPointerException npe<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        <span style="color:#75715e">// No valid phone numbers were provided
</span><span style="color:#75715e"></span>        response<span style="color:#f92672">.</span><span style="color:#a6e22e">put</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;status&#34;</span><span style="color:#f92672">,</span> 400<span style="color:#f92672">);</span>
        response<span style="color:#f92672">.</span><span style="color:#a6e22e">put</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;message&#34;</span><span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;No phone numbers were provided&#34;</span><span style="color:#f92672">);</span>
        <span style="color:#66d9ef">return</span> badRequest<span style="color:#f92672">(</span>response<span style="color:#f92672">);</span>
    <span style="color:#f92672">}</span></code></pre></div>

  </section>
</article>

</main>

</div>

<footer>
  <div class="container">
    <span class="copyright">&copy; 2015 barakyo - <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a></span>
  </div>
</footer>

</body>
</html>

